{# templates/_sections/hero-sections/hero-arrow.twig #}

{% set sourceEntry = entry ?? craft.entries.section('accounting').one() %}
{% set heroBlock = (sourceEntry and sourceEntry.infoBlock is defined and sourceEntry.infoBlock) ? sourceEntry.infoBlock.type('hero').one() : null %}

{# Image Logic #}
{% set heroImageAsset = props.imageAsset ?? ((heroBlock and heroBlock.heroImage is defined) ? heroBlock.heroImage.one() : null) %}
{% set fallbackImage = craft.vite.asset(props.imagePath ?? 'images/placeholder/hero-sample.jpg') ?: alias('@web/assets/' ~ (props.imagePath ?? 'images/placeholder/hero-sample.jpg')) %}

{# Arrow Logic: Using the disk path for reliability #}
{% set arrowPath = '@webroot/dist/images/placeholder/Arrow_1.svg' %}

{% set defaults = {
    backgroundColor: 'bg-foxplan-yellow',
    heading: heroBlock.title ?? sourceEntry.title ?? 'First Home Buyers',
    bodyText: entry.heroBodyText ?? '',
    buttonText: (heroBlock and heroBlock.button) ? heroBlock.button : null,
    buttonBgColor: 'bg-foxplan-charcoal-brown',
    buttonTextColor: 'text-foxplan-yellow',
    textColor: 'text-foxplan-charcoal-brown'
} %}

{% set data = defaults | merge(props ?? {}) %}

<section class="w-full py-16 {{ data.backgroundColor }} overflow-hidden"
         x-data="{ revealed: false }"
         x-init="setTimeout(() => revealed = true, 150)">

    <div class="flex flex-wrap w-full items-center mb-10 relative">

        {# --- THE ARROW: Matching Testimonial Logic (Starts from Edge, Not Too Big) --- #}
        <div class="hidden md:flex w-[30%] items-center justify-start pr-8 lg:pr-12">
            <div class="w-full h-8 flex items-center">
                <div class="transition-all duration-[2500ms] overflow-hidden"
                     style="transition-timing-function: steps(15); width: 0px; opacity: 0;"
                     :style="revealed ? 'width: 100%; opacity: 1;' : 'width: 0px; opacity: 0;'">

                    <div class="w-full h-auto fill-current {{ data.textColor }}">
                        {{ svg(alias(arrowPath))|attr({
                            class: 'w-full h-auto block object-contain max-h-6 object-left',
                            role: 'presentation'
                        }) }}
                    </div>
                </div>
            </div>
        </div>

        {# --- THE TEXT --- #}
        <div class="w-full md:w-[70%] px-8 md:px-0">
            <h2 class="font-serif text-6xl md:text-8xl lg:text-[7rem] leading-[0.85] tracking-tight {{ data.textColor }} whitespace-nowrap">
                {{ data.heading | raw }}
            </h2>
        </div>
    </div>

    <div class="flex flex-wrap lg:flex-nowrap items-end">
        <div class="w-full lg:w-[70%] relative overflow-hidden">
            <div class="relative w-full aspect-[16/9] lg:aspect-auto lg:h-[600px]">
                <img src="{{ heroImageAsset ? heroImageAsset.url : fallbackImage }}" alt="{{ data.heading | striptags }}" class="w-full h-full object-cover">
            </div>
        </div>
        <div class="w-full lg:w-[30%] px-8 lg:px-12 space-y-6 pt-10 lg:pt-0">
            {% if data.bodyText %}<div class="font-aktiv leading-relaxed text-xl {{ data.textColor }}">{{ data.bodyText | raw }}</div>{% endif %}
            {% if data.buttonText %}
                <div class="mt-4">
                    {% include '_components/ui/button/button.twig' with {
                        props: { text: data.buttonText, style: 'primary', url: data.buttonUrl ?? '#', backgroundColor: data.buttonBgColor, textColor: data.buttonTextColor }
                    } only %}
                </div>
            {% endif %}
        </div>
    </div>
</section>