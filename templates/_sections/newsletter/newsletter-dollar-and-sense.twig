{# templates/_sections/newsletter/newsletter-dollar-and-sense.twig #}

{# 1. Setup Scoped Color Defaults #}
{% set defaults = {
    heading: 'The Dollars and Sense Newsletter',
    description: 'Donâ€™t have time to listen? Get the low-down on the latest episode of Dollars and Sense with our regular episode newsletter.',
    backgroundColor: 'bg-white',
    headingColor: 'text-gray-900',
    bodyColor: 'text-black',
    borderColor: 'border-gray-300',
    accentColor: 'text-gray-500'
} %}

{% set sectionData = defaults | merge(data ?? {}) %}

{# 2. FETCH LATEST 3 ARTICLES #}
{% set latestArticles = craft.entries()
    .section('article')
    .limit(3)
    .with(['heroImage'])
    .all()
%}

<section class="w-full {{ sectionData.backgroundColor }} pt-16 pb-16 md:pt-24 md:pb-24">
    <div class="px-8 md:px-12 w-full">

        {# Heading #}
        <h2 class="font-serif text-5xl md:text-7xl lg:text-8xl font-normal {{ sectionData.headingColor }} leading-[0.85] tracking-tight mb-6 max-w-4xl">
            {{ sectionData.heading }}
        </h2>

        {# Description #}
        <p class="text-lg md:text-xl {{ sectionData.bodyColor }} leading-relaxed max-w-xl mb-12 opacity-90">
            {{ sectionData.description }}
        </p>

        {# Horizontal Divider #}
        <div class="w-full border-t {{ sectionData.borderColor }} mb-16"></div>

        {# Dynamic Articles Grid #}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-x-12 gap-y-16">

            {% for article in latestArticles %}
                {% set thumb = article.heroImage.one() %}

                <div class="group">
                    {# Image Container #}
                    <div class="w-full aspect-[5/3] mb-6 overflow-hidden bg-gray-100">
                        {% if thumb %}
                            <img src="{{ thumb.url }}"
                                 alt="{{ article.title }}"
                                 class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                        {% else %}
                            {# Fallback if no image exists #}
                            <div class="w-full h-full bg-foxplan-charcoal-brown/10 flex items-center justify-center font-serif opacity-20 italic">
                                foxplan
                            </div>
                        {% endif %}
                    </div>

                    {# Date #}
                    <p class="text-xs font-medium uppercase tracking-widest mb-3 {{ sectionData.accentColor }}">
                        {{ article.postDate | date('M d, Y') }}
                    </p>

                    {# Title Link #}
                    <a href="{{ article.url }}" class="block mb-4">
                        <h3 class="text-xl md:text-2xl font-serif leading-tight {{ sectionData.headingColor }} group-hover:opacity-70 transition-opacity">
                            {{ article.title }}
                        </h3>
                    </a>

                    {# CTA #}
                    <a href="{{ article.url }}" class="inline-block text-xs font-bold uppercase tracking-widest border-b-2 border-transparent hover:border-current transition-all {{ sectionData.accentColor }}">
                        READ MORE 
                    </a>
                </div>
            {% endfor %}

        </div>
    </div>
</section>