{# templates/_sections/content-sections/how-we-work.twig #}

{% set defaults = {
    mainHeading: entry.paragraphHeading ?? 'How we work with you',
    mainBody: entry.bodyText ?? '',
    accordionField: entry.accordion ?? null,
    backgroundColor: 'bg-foxplan-yellow',
    textColor: 'text-foxplan-charcoal-brown'
} %}

{% set data = defaults | merge(props ?? {}) %}

<section class="w-full relative z-20 {{ data.backgroundColor }} pt-16 md:pt-24 pb-16 md:pb-24 overflow-hidden">
    {# Strict 10-column grid for the 30/70 split #}
    <div class="grid grid-cols-1 md:grid-cols-10 w-full items-start">

        {# --- Left Side (30% Gutter) --- #}
        <div class="hidden md:block md:col-span-3"></div>

        {# --- Right Side (70% Content) --- #}
        <div class="col-span-1 md:col-span-7 px-8 md:pl-12 lg:pr-32">

            {# --- Intro Text above the accordion --- #}
            <div class="max-w-3xl mb-12">
                <h2 class="font-serif text-5xl lg:text-[5.5rem] font-light leading-[0.8] {{ data.textColor }} tracking-tight mb-8">
                    {{ data.mainHeading | raw }}
                </h2>

                {% if data.mainBody %}
                    <div class="font-aktiv text-base md:text-lg leading-relaxed {{ data.textColor }} opacity-80 max-w-2xl">
                        {{ data.mainBody | raw }}
                    </div>
                {% endif %}
            </div>

            {# --- The Accordion with smaller text --- #}
            <div class="w-full">
                {% if data.accordionField and data.accordionField.exists() %}

                {% set formattedItems = [] %}
                {% for item in data.accordionField.all() %}
                    {% set formattedItems = formattedItems | merge([{
                        expandableHeadingTitle: item.accordionHeading,
                        ExpandableBodyText: item.accordionBodyText
                    }]) %}
                {% endfor %}

                {% include '_components/ui/accordion/accordion.twig' with {
                props: {
                items: formattedItems,
                defaultOpen: 0,
                titleFont: 'font-serif',
                titleSize: 'text-xl md:text-[1.8rem]',
                titleWeight: 'font-light',
                textColor: data.textColor,
                backgroundColor: 'bg-foxplan-white',
                classes: 'w-full'
                }
                } only %}
                {% endif %}
            </div>
        </div>
    </div>
</section>