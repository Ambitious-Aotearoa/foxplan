{# 1. Safe Data Fetching: Pulling the latest 3 articles #}
{% set relatedArticles = craft.entries()
    .section('article')
    .limit(3)
    .all() %}

{% if relatedArticles|length > 0 %}
    <section class="w-full bg-foxplan-charcoal-brown pt-12 lg:pt-24 pb-0 relative overflow-hidden">

        <div class="px-4 md:px-6 lg:px-8 relative z-10">
            <h2 class="font-serif text-foxplan-neutral-beige mb-8 lg:mb-16 tracking-tight"
                style="font-size: clamp(2.5rem, 5vw, 4.5rem);">
                Latest insights
            </h2>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-x-12 lg:gap-x-20">
                {% for article in relatedArticles %}
                    <div class="pt-4 lg:pt-8 pb-6 lg:pb-12 border-t border-foxplan-neutral-beige/10 flex flex-col items-start group">
                        <p class="font-aktiv text-[10px] uppercase tracking-[0.2em] text-foxplan-neutral-beige/40 mb-4">
                            {{ article.postDate | date('F d, Y') | upper }}
                        </p>

                        <a href="{{ article.url }}" class="block mb-8">
                            {# Fluid clamp for heading size #}
                            <h3 class="font-serif text-foxplan-neutral-beige group-hover:opacity-70 transition-opacity leading-[1.15]"
                                style="font-size: clamp(1.5rem, 2vw + 0.5rem, 2.2rem);">
                                {{ article.title }}
                            </h3>
                        </a>

                        <a href="{{ article.url }}" class="font-aktiv text-[10px] uppercase tracking-[0.2em] text-foxplan-neutral-beige border-b border-foxplan-neutral-beige/30 hover:border-foxplan-neutral-beige transition-all pb-1">
                            READ MORE
                        </a>
                    </div>
                {% endfor %}
            </div>
        </div>

        {# --- THE STATIC ARCS --- #}
        <div class="relative w-full h-[200px] md:h-[300px] lg:h-[400px] mt-4 pointer-events-none hidden lg:block overflow-visible px-4 md:px-6 lg:px-8">

            <div class="relative w-full h-full text-foxplan-neutral-beige opacity-100">

                <svg class="w-full h-auto block fill-none stroke-current overflow-visible"
                     viewBox="0 0 2100 410"
                     xmlns="http://www.w3.org/2000/svg"
                     style="min-width: 2100px;">
                    <g stroke-width="1.2">
                        {# 3 Solid Circular Arcs #}
                        <path d="M0,400 A350,350 0 0,1 700,400 A350,350 0 0,1 1400,400 A350,350 0 0,1 2100,400"
                              style="stroke: currentColor;" />

                        {# Dashed Circular Arcs #}
                        <path class="opacity-40"
                              stroke-dasharray="12, 8"
                              d="M-350,400 A350,350 0 0,1 350,400 A350,350 0 0,1 1050,400 A350,350 0 0,1 1750,400 A350,400 0 0,1 2450,400"
                              style="stroke: currentColor;" />
                    </g>
                </svg>
            </div>
        </div>
    </section>
{% endif %}