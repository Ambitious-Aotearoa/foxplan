{# _sections/contact-us/contact-us.twig #}

{% set contactData = {
    call: {
        heading: 'Message us',
        description: 'New to FoxPlan? Please tell us which service you\'re interest in and one of our Advisers will be in touch soon. Alternatively, you can request a call back below.',
        phone1: '0800 NO STRESS (0800 667 873)',
        phone2: 'Office: (04) 918 4659',
        form: {
            fields: [
                { label: 'FIRST NAME', name: 'first_name', placeholder: 'John', type: 'text', colSpan: 6, value: 'John' },
                { label: 'LAST NAME', name: 'last_name', placeholder: 'Doe', type: 'text', colSpan: 6, value: 'Doe' },
                { label: 'I AM INTERESTED IN', name: 'interest', placeholder: 'Insurance', type: 'select', options: ['Insurance', 'Mortgages', 'KiwiSaver'], colSpan: 6 },
                { label: 'BEST TIME TO CALL', name: 'call_time', placeholder: 'Morning', type: 'select', options: ['Morning', 'Afternoon', 'Evening'], colSpan: 6 },
                { label: 'PHONE', name: 'phone', placeholder: '1234 567 890', type: 'tel', colSpan: 6, value: '1234 567 690' },
                { label: 'EMAIL', name: 'email', placeholder: 'johndoe@email.com', type: 'email', colSpan: 6, value: 'johndoe@email.com' },
                { label: 'MESSAGE', name: 'message', placeholder: 'Enter you message', type: 'textarea', colSpan: 12 }
            ],
            submitText: 'Submit',
            formAction: '#'
        }
    },
    callback: {
        heading: 'Request a Callback',
        body1: 'Set up a call with one of our advisers at a time that suits you. If you\'re new to FoxPlan, please let us know which services you are interested in so we can match you with the right adviser.',
        body2: 'If you know who you would like to speak to, you can select their name from the dropdown list.',
        placeholderText: 'Calendly embed'
    },
    location: {
        heading: 'Our Location',
        body: 'Visiting our office? You\'ll find us at Level 8, 138 The Terrace Wellington.',
        placeholderText: 'Map embed'
    }
} %}

{% set descriptionClasses = 'text-base text-gray-700 leading-relaxed mb-6' %}
{% set phoneClasses = 'text-base text-gray-900 font-semibold block mb-1' %}
{% set labelClasses = 'text-sm font-semibold text-gray-900 uppercase tracking-wider mb-2 block' %}
{% set inputClasses = 'w-full py-2 border-b border-gray-400 focus:outline-none focus:border-gray-900 bg-transparent placeholder-gray-500 text-gray-900' %}
{% set submitButtonClasses = 'bg-black text-white py-3 px-8 text-sm font-bold uppercase tracking-wider hover:bg-gray-800 rounded-lg' %}
{% set tabTitleClasses = 'font-serif text-4xl sm:text-5xl lg:text-[4rem] font-light leading-none text-gray-900 mb-6' %}


{% macro render_call_tab_content(data, descriptionClasses, phoneClasses, labelClasses, inputClasses, submitButtonClasses) %}
    <div class="grid grid-cols-1 md:grid-cols-12 gap-x-12">

        <div class="md:col-span-5 mb-12 md:mb-0">
            <p class="{{ descriptionClasses }} max-w-md">
                {{ data.description }}
            </p>

            <div class="pt-4">
                <span class="{{ phoneClasses }}">PHONE</span>
                <span class="{{ phoneClasses }} font-normal">{{ data.phone1 }}</span>
                <span class="{{ phoneClasses }} font-normal">{{ data.phone2 }}</span>
            </div>
        </div>

        <div class="md:col-span-7">
            {# Reverted to POST, relying on the Script at the bottom to fix the dialog #}
            <form action="{{ data.form.formAction }}" method="POST">
                <div class="grid grid-cols-12 gap-x-8 gap-y-12">

                    {% for field in data.form.fields %}
                        <div class="col-span-{{ field.colSpan }}">
                            <label for="{{ field.name }}" class="{{ labelClasses }}">{{ field.label }}</label>

                            {% if field.type == 'select' %}
                                <div class="relative">
                                    <select id="{{ field.name }}" name="{{ field.name }}" class="{{ inputClasses }} appearance-none pr-8" required>
                                        {% for option in field.options %}
                                            <option value="{{ option }}" {% if loop.index == 1 %}selected{% endif %}>{{ option }}</option>
                                        {% endfor %}
                                    </select>
                                    <svg class="absolute right-0 top-3 w-4 h-4 text-gray-700 pointer-events-none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                                </div>
                            {% elseif field.type == 'textarea' %}
                                <textarea id="{{ field.name }}" name="{{ field.name }}" placeholder="{{ field.placeholder }}" rows="4" class="{{ inputClasses }} resize-none" required></textarea>
                            {% else %}
                                <input
                                        type="{{ field.type }}"
                                        id="{{ field.name }}"
                                        name="{{ field.name }}"
                                        placeholder="{{ field.placeholder }}"
                                        class="{{ inputClasses }}"
                                        value="{{ field.value ?? '' }}"
                                        required
                                >
                            {% endif %}
                        </div>
                    {% endfor %}

                    <div class="col-span-12 mt-4">
                        {{ include('_components/ui/button/button.twig', {
                            props: {
                                text: data.form.submitText,
                                style: 'secondary',
                                classes: 'text-sm font-bold uppercase tracking-wider',
                                attributes: {
                                    type: 'submit'
                                }
                            }
                        }) }}
                    </div>

                </div>
            </form>
        </div>
    </div>
{% endmacro %}

{% macro render_callback_tab_content(data, descriptionClasses) %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12">

        <div class="mb-12 md:mb-0">
            <p class="{{ descriptionClasses }} max-w-md">
                {{ data.body1 }}
            </p>

            <p class="{{ descriptionClasses }} max-w-md">
                {{ data.body2 }}
            </p>
        </div>

        <div class="h-[450px] bg-gray-100 flex items-center justify-center">
            <span class="text-gray-500">{{ data.placeholderText }}</span>
        </div>

    </div>
{% endmacro %}

{% macro render_location_tab_content(data, descriptionClasses) %}
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12">

        <div class="mb-12 md:mb-0">
            <p class="{{ descriptionClasses }} max-w-md">{{ data.body }}</p>
        </div>

        <div class="h-[450px] bg-gray-100 flex items-center justify-center">
            <span class="text-gray-500">{{ data.placeholderText }}</span>
        </div>
    </div>
{% endmacro %}

{% import _self as macros %}


{% set tabsComponentData = {
    defaultTab: 'call',
    backgroundColor: 'bg-white',
    textColor: 'text-gray-900',
    titleClasses: tabTitleClasses,

    tabs: [
        {
            id: 'call',
            label: 'Call FoxPlan',
            title: contactData.call.heading,
            content: macros.render_call_tab_content(contactData.call, descriptionClasses, phoneClasses, labelClasses, inputClasses, submitButtonClasses),
        },
        {
            id: 'callback',
            label: 'Request a Callback',
            title: contactData.callback.heading,
            content: macros.render_callback_tab_content(contactData.callback, descriptionClasses),
        },
        {
            id: 'location',
            label: 'Our Location',
            title: contactData.location.heading,
            content: macros.render_location_tab_content(contactData.location, descriptionClasses),
        }
    ]
} %}


<section class="w-full {{ tabsComponentData.backgroundColor }} pt-16 pb-16 md:pt-24 md:pb-24">
    <div class="mx-auto px-4">

        {% include '_components/ui/tabs/tabs.twig' with {
            data: tabsComponentData
        } %}

    </div>
</section>

