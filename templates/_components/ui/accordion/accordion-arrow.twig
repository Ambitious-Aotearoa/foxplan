{# templates/_sections/content-sections/accordion-arrow.twig #}

{% set defaults = {
    mainHeading: entry.paragraphHeading2 ?? 'Get personalised advice',
    accordionField: entry.accordionArrow ?? null,
    backgroundColor: 'bg-foxplan-neutral-beige',
    textColor: 'text-foxplan-charcoal-brown',
    arrowPath: 'images/placeholder/Arrow_1.svg'
} %}

{% set data = defaults | merge(props ?? {}) %}

{% if data.mainHeading or (data.accordionField and data.accordionField.exists()) %}
    <section class="w-full {{ data.backgroundColor }} pt-16 md:pt-24 pb-16 md:pb-24 overflow-hidden"
             x-data="{
            revealed: false,
            checkScroll() {
                if (this.revealed) return;
                let rect = this.$el.getBoundingClientRect();
                if (rect.top < window.innerHeight && rect.bottom >= 0) {
                    this.revealed = true;
                }
            }
         }"
             x-init="setTimeout(() => checkScroll(), 200)"
             @scroll.window.passive="checkScroll()">

        <div class="w-full">
            <div class="flex flex-wrap w-full items-start">

                {# --- LEFT SIDE: Arrow Decor --- #}
                <div class="hidden md:flex md:w-[30%] items-start justify-start pr-8 pt-6 md:pt-10">
                    <div class="w-full h-8 flex items-center">
                        <div class="transition-all duration-[2500ms] overflow-hidden"
                             style="transition-timing-function: steps(15); width: 0px; opacity: 0;"
                             :style="revealed ? 'width: 100%; opacity: 1;' : 'width: 0px; opacity: 0;'">
                            <img src="{{ craft.vite.asset(data.arrowPath) }}"
                                 alt="Arrow Decor"
                                 class="w-full h-auto object-contain max-h-8 object-left block">
                        </div>
                    </div>
                </div>

                {# --- RIGHT SIDE: Content --- #}
                <div class="w-full md:w-[70%] px-8 md:px-0 pr-8 md:pr-24 lg:pr-48">

                    {% if data.mainHeading %}
                        <h2 class="font-serif text-5xl md:text-7xl lg:text-[5.5rem] mb-16 leading-[0.9] {{ data.textColor }} tracking-tight font-light">
                            {{ data.mainHeading | raw }}
                        </h2>
                    {% endif %}

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 md:gap-x-20 gap-y-10 md:gap-y-16">
                        {% if data.accordionField and data.accordionField.exists() %}
                            {% for item in data.accordionField.all() %}
                                {% if item.accordionHeading1 or item.bodyText %}
                                    <div class="flex gap-4 items-start">
                                        {# Decorative Gold Accent #}
                                        <div class="w-1 bg-foxplan-yellow shrink-0 h-8 mt-1"></div>

                                        <div class="font-aktiv {{ data.textColor }}">
                                            {# Accordion Heading: Bold removed as requested #}
                                            {% if item.accordionHeading1 %}
                                                <h3 class="text-xl font-normal mb-2  tracking-widest text-[10px]">
                                                    {{ item.accordionHeading1 }}
                                                </h3>
                                            {% endif %}

                                            {# Body Text: Ensuring natural weight #}
                                            <div class="text-lg md:text-xl font-normal leading-snug opacity-90 [&_p]:mb-0">
                                                {{ item.bodyText | raw }}
                                            </div>
                                        </div>
                                    </div>
                                {% endif %}
                            {% endfor %}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endif %}