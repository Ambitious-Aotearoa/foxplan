{# _components/ui/tabs/tabs.twig #}

{% set defaultTab = data.defaultTab ?? 'call' %}
{% set backgroundColor = data.backgroundColor ?? 'bg-white' %}
{% set textColor = data.textColor ?? 'text-foxplan-charcoal-brown' %}

{% set initialLabel = '' %}
{% for tab in data.tabs %}
    {% if tab.id == defaultTab %}{% set initialLabel = tab.label %}{% endif %}
{% endfor %}

<div class="tabs-component {{ backgroundColor }}"
     x-data="{
        selectedTab: '{{ defaultTab }}',
        mobileMenuOpen: false,
        selectedLabel: '{{ initialLabel }}'
     }">

    {# --- MOBILE DROPDOWN --- #}
    <div class="md:hidden mb-8 relative px-4">
        <button @click="mobileMenuOpen = !mobileMenuOpen"
                class="w-full flex items-center justify-between px-4 py-3 border border-b-foxplan-charcoal-brown-300 rounded-md bg-transparent {{ textColor }} font-aktiv font-medium">
            <span x-text="selectedLabel"></span>
            <svg class="w-5 h-5 transition-transform duration-200" :class="mobileMenuOpen ? 'rotate-180' : ''" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </button>

        <div x-show="mobileMenuOpen" @click.away="mobileMenuOpen = false" x-cloak
             class="absolute z-10 left-4 right-4 mt-1 bg-foxplan-white border border-b-foxplan-charcoal-brown-200 rounded-md shadow-lg overflow-hidden">
            {% for tab in data.tabs %}
                <button @click="selectedTab = '{{ tab.id }}'; selectedLabel = '{{ tab.label }}'; mobileMenuOpen = false"
                        class="w-full text-left px-4 py-3 hover:bg-foxplan-neutral-beige transition-colors duration-200 {{ textColor }} font-aktiv"
                        :class="selectedTab === '{{ tab.id }}' ? 'bg-foxplan-charcoal-brown-50 font-bold' : ''">
                    {{ tab.label }}
                </button>
            {% endfor %}
        </div>
    </div>

    {# --- DESKTOP TABS --- #}
    <div class="hidden md:flex w-full border-b border-gray-300 mb-12 overflow-x-auto scrollbar-hide">
        {% for tab in data.tabs %}
            <button @click="selectedTab = '{{ tab.id }}'; selectedLabel = '{{ tab.label }}'"
                    class="flex-1 py-4 px-6 font-aktiv font-medium transition-all duration-300 border-b-2 text-center whitespace-nowrap"
                    :class="selectedTab === '{{ tab.id }}' ? 'border-foxplan-charcoal-brown text-foxplan-charcoal-brown' : 'border-transparent text-foxplan-charcoal-brown-400 '"
                    type="button">
                {{ tab.label }}
            </button>
        {% endfor %}
    </div>

    <div class="tabs-content mx-auto">
        {% for tab in data.tabs %}
            <div x-cloak x-show="selectedTab === '{{ tab.id }}'"
                 x-transition:enter="transition ease-out duration-300"
                 x-transition:enter-start="opacity-0 translate-y-4"
                 x-transition:enter-end="opacity-100 translate-y-0"
                 class="tab-panel">
                <div class="tab-main-layout">
                    {{ tab.content | raw }}
                </div>
            </div>
        {% endfor %}
    </div>
</div>