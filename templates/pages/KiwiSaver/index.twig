{# 1. Extend the base boilerplate #}
{% extends "_boilerplate/_layouts/layout-base.twig" %}

{% set navigationTheme = {
    backgroundColor: 'bg-foxplan-neutral-beige',
    textColor: 'text-black',
    actionBgColor: 'bg-foxplan-charcoal-brown'
} %}
{# 2. Fill the body block defined in layout-base #}
{% block blockAppBody %}

    {# 1. Hero Section #}
    {% set pageHeading = (entry.title is defined and entry.title|length) ? entry.title : 'Mortgages' %}
    {% set pageBody = (entry.heroBodyText is defined and entry.heroBodyText|length) ? entry.heroBodyText : "Whether you're buying your first home, or you're a seasoned investor, we can help you find the right mortgage." %}
    {% set pageButton = (entry.button is defined and entry.button|length) ? entry.button : 'Book a call' %}
    {% set pageButtonUrl = (entry.buttonLink is defined and entry.buttonLink|length) ? entry.buttonLink : '#' %}

    {% include '_sections/hero-sections/hero-1.twig' with {
        entry: entry,
        props: {
            title: pageHeading,
            bodyText: pageBody,
            button: pageButton,
            buttonLink: pageButtonUrl,
            backgroundColor:  'bg-foxplan-neutral-beige'
        }
    } %}

    {# 2. Explore Services Section #}
    {% include "_sections/content-sections/help-for-buying-your-first-home.twig" with {
        props: {
            mainHeading: entry.paragraphHeading ?? 'Our Services',
            services: entry.infoBlock.all() ?? [],
            backgroundColor: 'bg-foxplan-neutral-beige',
            textColor: 'text-foxplan-charcoal-brown',
            borderColor: 'border-foxplan-charcoal-brown/20'
        }
    } only %}

    {# 3. Benefits Accordion  #}
    {#    {# 7. Personalised Advice Section (Matrix: accordionArrow) #}
    {% include "_components/ui/accordion/accordion-arrow.twig" with {
        props: {
            mainHeading: entry.paragraphHeading2,
            accordionField: entry.accordionArrow,
            backgroundColor: 'bg-foxplan-neutral-beige'
        }
    } only %}

    {# 4. How We Work Section (Matrix: accordion) #}
    {% set benefitsHeading = entry.paragraphHeading3 ?? 'About group insurance' %}
    {% set benefitsIntro = entry.bodyText ?? '' %}

    {# 1. Loop through the 'accordion' matrix #}
    {% set accordionItems = [] %}
    {# Ensure 'accordion' is the handle of the Matrix field on this specific entry #}
    {% if entry.accordion is defined %}
        {% for block in entry.accordion.all() %}
            {% set accordionItems = accordionItems | merge([{
                'title': block.accordionHeading,
                'text': block.accordionBodyText
            }]) %}
        {% endfor %}
    {% endif %}

    {#  Deliver the data to the benefits section using 'props' #}
    {{ include('_sections/content-sections/benefits.twig', {
        props: {
            paragraphHeading: benefitsHeading,
            bodyText: benefitsIntro,
            items: accordionItems,
            backgroundColor: 'bg-foxplan-yellow',
            textColor: 'text-foxplan-charcoal-brown'
        }
    }) }}

    {# 5. iamge and text #}
    {% include "_sections/hero-sections/section.twig" with {
        entry: entry,
        props: {
            backgroundColor: 'bg-foxplan-yellow',
            title: entry.paragraphHeading4 ?? 'Get the First Home Buyers Guide',
            bodyText: entry.bodyText2 ?? '',
            buttonText: entry.button2 ?? '',
        }
    } %}


    {# 6. Client Testimonials Carousel #}
    {% include "_sections/testimonials/testimonial-two.twig" with {
        data: {
            sectionTitle: entry.paragraphHeading5 ?? 'Hear what our clients are saying',
            backgroundColor: 'bg-foxplan-neutral-beige',
            textColor: 'text-foxplan-charcoal-brown'
        }
    } %}



    {#  footer #}
    {{ include('_components/footer/footer-High-fidelity.twig', {
        props: {
            backgroundColor: 'bg-foxplan-charcoal-brown',
            textColor: 'text-foxplan-yellow',
            logoColor: 'text-foxplan-yellow',
            buttonColor: 'bg-foxplan-yellow',
            buttonTextColor: 'text-foxplan-charcoal-brown',
            foxplanText: 'foxplan',
            borderTopColor: 'border-foxplan-yellow/20',
            borderTopWidth: 'border-t-2'
        }
    }) }}


{% endblock %}